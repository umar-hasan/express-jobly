(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{173:function(e,t,n){},192:function(e,t,n){},202:function(e,t){},204:function(e,t){},218:function(e,t){},220:function(e,t){},248:function(e,t){},250:function(e,t){},251:function(e,t){},256:function(e,t){},258:function(e,t){},277:function(e,t){},289:function(e,t){},292:function(e,t){},310:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(43),s=n.n(a),u=(n(173),n(5)),o=n.n(u),i=n(10),l=n(12),j=n(17),b=n(9),p=n(160),h=n(161),d=n(89),O=n.n(d),f=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BASE_URL||"http://localhost:3001",x=function(){function e(){Object(p.a)(this,e)}return Object(h.a)(e,null,[{key:"request",value:function(){var t=Object(i.a)(o.a.mark((function t(n){var r,c,a,s,u,i,l=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:{},c=l.length>2&&void 0!==l[2]?l[2]:"get",console.debug("API Call:",n,r,c),a="".concat(f,"/api/").concat(n),s={Authorization:"Bearer ".concat(e.token)},u="get"===c?r:{},t.prev=6,t.next=9,O()({url:a,method:c,data:r,params:u,headers:s});case 9:return t.abrupt("return",t.sent.data);case 12:throw t.prev=12,t.t0=t.catch(6),console.error("API Error:",t.t0.response),i=t.t0.response.data.error.message,Array.isArray(i)?i:[i];case 17:case"end":return t.stop()}}),t,null,[[6,12]])})));return function(e){return t.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("auth/token",t,"post");case 2:return n=e.sent,this.token=n.token,e.abrupt("return",n.token);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("auth/register",t,"post");case 2:return n=e.sent,this.token=n.token,e.abrupt("return",n.token);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.token&&(this.token=null)}},{key:"getCurrentUser",value:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("users/".concat(t));case 2:return n=e.sent,e.abrupt("return",n.user);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(){var e=Object(i.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("users/".concat(t),n,"patch");case 2:return r=e.sent,e.abrupt("return",r.user);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"applyToJob",value:function(){var e=Object(i.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("users/".concat(t,"/jobs/").concat(n),{},"post");case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getCompany",value:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("companies/".concat(t));case 2:return n=e.sent,e.abrupt("return",n.company);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllCompanies",value:function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("companies");case 2:return t=e.sent,e.abrupt("return",t.companies);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAllJobs",value:function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("jobs");case 2:return t=e.sent,e.abrupt("return",t.jobs);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();x.token=localStorage.getItem("jobly-token");var m=x,v=(n(192),n(317)),g=n(312),y=Object(r.createContext)(),w=n(1);function k(e){var t=e.job,n=Object(r.useContext)(y).currentUser,c=Object(r.useState)(n.applications.includes(t.id)),a=Object(l.a)(c,2),s=a[0],u=a[1];function j(){return(j=Object(i.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.applyToJob(n.username,t);case 2:return r=e.sent,console.log(r),u(!0),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){u(n.applications.includes(t.id))}),[n.applications]),Object(w.jsx)(v.a,{children:Object(w.jsxs)(v.a.Body,{children:[Object(w.jsx)(v.a.Title,{children:t.title}),Object(w.jsxs)("p",{children:["Salary: ",Object(w.jsx)("span",{children:t.salary})]}),Object(w.jsxs)("p",{children:["Equity: ",Object(w.jsx)("span",{children:t.equity})]}),Object(w.jsx)(g.a,{onClick:function(){return function(e){return j.apply(this,arguments)}(t.id)},disabled:s,children:s?"Applied":"Apply"})]})})}function C(){var e=Object(b.h)(),t=Object(r.useState)({}),n=Object(l.a)(t,2),c=n[0],a=n[1],s=Object(r.useState)([]),u=Object(l.a)(s,2),j=u[0],p=u[1];return Object(r.useEffect)((function(){(function(){var t=Object(i.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.getCompany(e.company);case 2:n=t.sent,a(n),p(n.jobs);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]),Object(w.jsxs)("div",{children:[Object(w.jsx)("h2",{children:c.name}),Object(w.jsx)("p",{children:c.description}),j.map((function(e){return Object(w.jsx)(k,{job:e})}))]})}function S(e){var t=e.company;return Object(w.jsx)(j.b,{to:"/companies/".concat(t.handle),children:Object(w.jsx)(v.a,{children:Object(w.jsxs)(v.a.Body,{children:[Object(w.jsxs)(v.a.Title,{children:[t.name,Object(w.jsx)("img",{src:t.logoUrl,className:"float-right ml-5"})]}),Object(w.jsx)("p",{children:Object(w.jsx)("small",{children:t.description})})]})})},t.handle)}function N(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){(function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.getAllCompanies();case 2:t=e.sent,c(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(w.jsx)("div",{children:n.map((function(e){return Object(w.jsx)(S,{company:e})}))})}function U(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1];Object(r.useContext)(y).currentUser;return Object(r.useEffect)((function(){(function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.getAllJobs();case 2:t=e.sent,c(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(w.jsx)("div",{className:"col-md-8 offset-md-2",children:n.map((function(e){return Object(w.jsx)(k,{job:e})}))})}var E=n(32),q=n(26),A=n(313),P=n(316),T=n(163),F=n(168),I=n(164);function _(e){var t=e.login,n=Object(b.g)(),c=Object(r.useState)({username:"",password:""}),a=Object(l.a)(c,2),s=a[0],u=a[1],j=function(){var e=Object(i.a)(o.a.mark((function e(r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,t(s);case 3:e.sent&&n.push("/");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(e){e.preventDefault(),u((function(t){return Object(q.a)(Object(q.a)({},t),{},Object(E.a)({},e.target.name,e.target.value))}))};return Object(w.jsxs)(A.a,{className:"col-md-6 offset-md-3 col-lg-4 offset-lg-4",children:[Object(w.jsx)("h2",{children:"Login"}),Object(w.jsx)(v.a,{children:Object(w.jsx)(v.a.Body,{children:Object(w.jsxs)(P.a,{onSubmit:j,children:[Object(w.jsxs)(T.a,{children:[Object(w.jsx)(F.a,{children:"Username"}),Object(w.jsx)(I.a,{type:"text",name:"username",placeholder:"Username",onChange:p,required:!0})]}),Object(w.jsxs)(T.a,{children:[Object(w.jsx)(F.a,{children:"Password"}),Object(w.jsx)(I.a,{type:"password",name:"password",placeholder:"Password",onChange:p,required:!0})]}),Object(w.jsx)(g.a,{type:"submit",children:"Submit"})]})})})]})}function L(e){var t=e.register,n=Object(b.g)(),c=Object(r.useState)({username:"",password:"",firstName:"",lastName:"",email:""}),a=Object(l.a)(c,2),s=a[0],u=a[1],j=function(e){u((function(t){return Object(q.a)(Object(q.a)({},t),{},Object(E.a)({},e.target.name,e.target.value))}))},p=function(){var e=Object(i.a)(o.a.mark((function e(r){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,t(s);case 3:c=e.sent,console.log(c),c.success&&n.push("/");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)(A.a,{className:"col-md-6 offset-md-3 col-lg-4 offset-lg-4",children:[Object(w.jsx)("h2",{children:"Register"}),Object(w.jsx)(v.a,{id:"register-form",children:Object(w.jsx)(v.a.Body,{children:Object(w.jsxs)(P.a,{onSubmit:p,children:[Object(w.jsxs)(T.a,{children:[Object(w.jsx)(F.a,{children:"Username"}),Object(w.jsx)(I.a,{type:"text",name:"username",onChange:j,required:!0})]}),Object(w.jsxs)(T.a,{children:[Object(w.jsx)(F.a,{children:"Password"}),Object(w.jsx)(I.a,{type:"password",name:"password",onChange:j,required:!0})]}),Object(w.jsxs)(T.a,{children:[Object(w.jsx)(F.a,{children:"First Name"}),Object(w.jsx)(I.a,{type:"text",name:"firstName",onChange:j,required:!0})]}),Object(w.jsxs)(T.a,{children:[Object(w.jsx)(F.a,{children:"Last Name"}),Object(w.jsx)(I.a,{type:"text",name:"lastName",onChange:j,required:!0})]}),Object(w.jsxs)(T.a,{children:[Object(w.jsx)(F.a,{children:"Email"}),Object(w.jsx)(I.a,{type:"email",name:"email",onChange:j,required:!0})]}),Object(w.jsx)(g.a,{type:"submit",children:"Submit"})]})})})]})}var B=n(93),D=n.n(B);function J(){var e=Object(r.useContext)(y).currentUser;return Object(w.jsx)("div",{id:"homepage",children:Object(w.jsxs)("div",{className:"container text-center",children:[Object(w.jsx)("h1",{children:"Jobly"}),Object(w.jsx)("p",{children:"All the jobs in one convenient place."}),e?Object(w.jsxs)("h3",{children:["Welcome back, ",e.firstName,"!"]}):Object(w.jsxs)("div",{children:[Object(w.jsx)(j.b,{to:"/login",children:Object(w.jsx)(g.a,{children:"Login"})}),Object(w.jsx)(j.b,{to:"/signup",children:Object(w.jsx)(g.a,{children:"Register"})})]})]})})}function R(e){var t=e.path,n=e.children,c=Object(r.useContext)(y).currentUser;return console.log(c),c?Object(w.jsx)(b.b,{path:t,children:n}):Object(w.jsx)(b.a,{to:"/login"})}function W(){var e=Object(r.useContext)(y),t=e.currentUser,n=e.setcurrentUser,c={password:"",firstName:t.firstName,lastName:t.lastName,email:t.email},a=Object(r.useState)(c),s=Object(l.a)(a,2),u=s[0],j=s[1],b=function(){var e=Object(i.a)(o.a.mark((function e(r){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,m.updateCurrentUser(t.username,u);case 4:c=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return");case 11:j((function(e){return Object(q.a)(Object(q.a)({},e),{},{password:""})})),n(c);case 13:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),p=function(e){e.preventDefault(),j((function(t){return Object(q.a)(Object(q.a)({},t),{},Object(E.a)({},e.target.name,e.target.value))}))};return Object(w.jsxs)("div",{className:"col-md-6 col-lg-4 offset-md-3 offset-lg-4",children:[Object(w.jsx)("h2",{children:"Profile"}),Object(w.jsx)(v.a,{children:Object(w.jsx)(v.a.Body,{children:Object(w.jsxs)(P.a,{onSubmit:b,children:[Object(w.jsxs)(T.a,{children:[Object(w.jsx)(F.a,{htmlFor:"",children:"Username"}),Object(w.jsx)(I.a,{plaintext:!0,readOnly:!0,defaultValue:t.username})]}),Object(w.jsxs)(T.a,{children:[Object(w.jsx)(F.a,{htmlFor:"first-name",children:"First Name"}),Object(w.jsx)(I.a,{name:"firstName",value:u.firstName,onChange:p})]}),Object(w.jsxs)(T.a,{children:[Object(w.jsx)(F.a,{htmlFor:"last-name",children:"Last Name"}),Object(w.jsx)(I.a,{name:"lastName",value:u.lastName,onChange:p})]}),Object(w.jsxs)(T.a,{children:[Object(w.jsx)(F.a,{htmlFor:"email",children:"Email"}),Object(w.jsx)(I.a,{name:"email",value:u.email,onChange:p})]}),Object(w.jsxs)(T.a,{children:[Object(w.jsx)(F.a,{htmlFor:"password",children:"Password"}),Object(w.jsx)(I.a,{name:"password",type:"password",value:u.password,onChange:p,required:!0})]}),Object(w.jsx)(g.a,{type:"submit",children:"Submit"})]})})})]})}var H=n(315),K=n(314),V=n(165);function z(e){var t=e.logout,n=Object(r.useContext)(y).currentUser;return Object(w.jsx)("div",{children:Object(w.jsxs)(K.a,{children:[Object(w.jsx)(V.a,{children:Object(w.jsx)(j.b,{to:"/",children:"Jobly"})}),n?Object(w.jsxs)(H.a,{className:"ml-auto mr-2",children:[Object(w.jsx)(j.c,{to:"/companies",children:"Companies"}),Object(w.jsx)(j.c,{to:"/jobs",children:"Jobs"}),Object(w.jsx)(j.c,{to:"/profile",children:"Profile"}),Object(w.jsx)(j.c,{to:"/",onClick:t,children:"Logout"})]}):Object(w.jsxs)(H.a,{className:"ml-auto mr-2",children:[Object(w.jsx)(j.c,{to:"/login",children:"Login"}),Object(w.jsx)(j.c,{to:"/signup",children:"Register"})]})]})})}n(309);var M=function(){var e=Object(r.useState)(null),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=localStorage.getItem(e)||t,c=Object(r.useState)(n),a=Object(l.a)(c,2),s=a[0];return a[1],Object(r.useEffect)((function(){null===s?localStorage.removeItem(e):localStorage.setItem(e,s)}),[e,s]),s}("jobly-token")),s=Object(l.a)(a,2),u=s[0],p=s[1],h=Object(r.useState)(!1),d=Object(l.a)(h,2),O=d[0],f=d[1];function x(){return(x=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.login(t);case 3:return n=e.sent,p(n),localStorage.setItem("jobly-token",n),e.abrupt("return",{success:!0});case 9:return e.prev=9,e.t0=e.catch(0),console.log("login failed",e.t0),e.abrupt("return",{success:!1});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function v(){return(v=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.register(t);case 3:return n=e.sent,p(n),localStorage.setItem("jobly-token",n),e.abrupt("return",{success:!0});case 9:return e.prev=9,e.t0=e.catch(0),console.error("signup failed",e.t0),e.abrupt("return",{success:!1});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function g(){return(g=Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.logout(),p(null),c(null),localStorage.removeItem("jobly-token");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){function e(){return(e=Object(i.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=15;break}return console.log(D.a.decode(u)),e.prev=2,t=D.a.decode(u).username,e.next=6,m.getCurrentUser(t);case 6:n=e.sent,console.log(n),c(n),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("App loadUserInfo: problem loading",e.t0),c(null);case 15:f(!0);case 16:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[u]),O?Object(w.jsx)("div",{className:"App",children:Object(w.jsx)(y.Provider,{value:{currentUser:n,setcurrentUser:c},children:Object(w.jsxs)(j.a,{children:[Object(w.jsx)(z,{logout:function(){return g.apply(this,arguments)}}),Object(w.jsxs)(b.d,{children:[Object(w.jsx)(b.b,{exact:!0,path:"/login",children:Object(w.jsx)(_,{login:function(e){return x.apply(this,arguments)}})}),Object(w.jsx)(b.b,{exact:!0,path:"/signup",children:Object(w.jsx)(L,{register:function(e){return v.apply(this,arguments)}})}),Object(w.jsx)(R,{path:"/profile",children:Object(w.jsx)(W,{})}),Object(w.jsx)(R,{path:"/companies/:company",children:Object(w.jsx)(C,{})}),Object(w.jsx)(R,{path:"/companies",children:Object(w.jsx)(N,{})}),Object(w.jsx)(R,{path:"/jobs",children:Object(w.jsx)(U,{})}),Object(w.jsx)(b.b,{exact:!0,path:"/",children:Object(w.jsx)(J,{})}),Object(w.jsx)(b.b,{children:"404 Page"})]})]})})}):null},G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,318)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};s.a.render(Object(w.jsx)(c.a.StrictMode,{children:Object(w.jsx)(M,{})}),document.getElementById("root")),G()}},[[310,1,2]]]);
//# sourceMappingURL=main.22d0e7f9.chunk.js.map